<!DOCTYPE html>
<html>

<head>
  <title>Distributed Chat</title>
  <link rel="stylesheet" type="text/css" href="style.css" />
  <!-- Socket.io library -->
  <script src="/socket.io/socket.io.js"></script>
  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <!-- jQuery library -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <!-- Latest compiled JavaScript -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script type="text/javascript">
    let pseudo;
    function pseudoFun() {
      let userInput = document.getElementById("pseudoForm").value;
      if (userInput !== "") {
        pseudo = userInput;
        console.log(pseudo);
        document.getElementById("formPseudo").style.display = "none";
        document.getElementById("formMessages").style.display = "block";
      }
    }

    $(function () {
      let socket = io();
      $("#formMessages").submit(function () {
        socket.emit("chat message", $("#m").val());
        $("#m").val("");
        return false;
      });
      socket.on("chat message", function (msg) {
        $("#messages").append($("<li>").text(pseudo + " wrote: " + msg));
      });
      socket.on("connection", function () {
        $("#messages").append($("<li>").text("New user connected"));
      });
    });
  </script>
</head>

<body>
  <div class="container">
    <ul id="messages"></ul>
    <form action="" class="form-group" id="formMessages">
      <label for="m">Enter your message:</label>
      <input id="m" autocomplete="off" autofocus required class="form-control" /><button class="btn">Send</button>
    </form>
    <form action="javascript:void(0);" id="formPseudo">
      <label for="pseudoForm">Enter your pseudo:</label>
      <input id="pseudoForm" autocomplete="off" autofocus required class="form-control" /><button class="btn" onclick="pseudoFun()">Send</button>
    </form>
  </div>
</body>

</html>